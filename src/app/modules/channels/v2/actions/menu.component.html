<m-dropdownMenu [menu]="actionsDropdown">
  <ng-content></ng-content>
</m-dropdownMenu>

<ng-template #actionsDropdown>
  <ul>
    <li
      *ngIf="service.isSubscribed$ | async; else subscribeOption"
      (click)="unsubscribe()"
    >
      <span class="m-dropdownMenu__item">
        <span i18n>Unsubscribe</span>
      </span>
    </li>
    <ng-template #subscribeOption>
      <li (click)="subscribe()">
        <span class="m-dropdownMenu__item">
          <span i18n>Subscribe</span>
        </span>
      </li>
    </ng-template>

    <!-- ******** admin block ******** -->
    <ng-container *ngIf="service.isAdmin$ | async">
      <li *ngIf="service.isBanned$ | async; else banOption" (click)="unBan()">
        <span class="m-dropdownMenu__item">
          <span i18n>Un-ban globally</span>
        </span>
      </li>
      <ng-template #banOption>
        <li (click)="ban()">
          <span class="m-dropdownMenu__item">
            <span i18n>Ban globally</span>
          </span>
        </li>
      </ng-template>
      <li
        (click)="viewLedger()"
        i18n="@@MINDS_BUTTON__USER_DROPDOWN__VIEW_LEDGER"
      >
        <span class="m-dropdownMenu__item">
          View Ledger
        </span>
      </li>
      <li
        (click)="viewWithdrawals()"
        i18n="@@MINDS_BUTTON__USER_DROPDOWN__VIEW_WITHDRAWALS"
      >
        <span class="m-dropdownMenu__item">
          View Withdrawals
        </span>
      </li>
      <li
        (click)="viewEmail()"
        i18n="@@MINDS_BUTTON__USER_DROPDOWN__VIEW_EMAIL_ADDR"
      >
        <span class="m-dropdownMenu__item">
          E-mail Address
        </span>
      </li>
    </ng-container>

    <ng-container *ngIf="!(service.isAdmin$ | async)">
      <li
        *ngIf="service.isBlocked$ | async; else blockOption"
        (click)="unblock()"
      >
        <span class="m-dropdownMenu__item">
          <span i18n>Unblock</span>
        </span>
      </li>
      <ng-template #blockOption>
        <li (click)="block()">
          <span class="m-dropdownMenu__item">
            <span i18n>Block</span>
          </span>
        </li>
      </ng-template>
    </ng-container>

    <li *ngIf="!(service.isAdmin$ | async)" (click)="report()">
      <span class="m-dropdownMenu__item">
        <span i18n>Report</span>
      </span>
    </li>
  </ul>
</ng-template>

<m-modal
  *ngIf="service.email$ | async as email"
  [open]="true"
  (closed)="service.email$.next(null)"
>
  <div
    class="mdl-card__supporting-text"
    style="padding: 64px; font-size: 20px; text-align: center;"
  >
    @{{ service.username$ | async }}'s email:
    <a
      *ngIf="email"
      [href]="'mailto:' + email"
      style="text-decoration: none;"
      >{{ email }}</a
    >
    <ng-container *ngIf="!email">...</ng-container>
  </div>
</m-modal>
