<a class="m-button-v2 m-button-v2--iconOnly" (click)="toggleMenu($event)">
  <m-icon from="md" [iconId]="'more_horiz'"></m-icon>
</a>

<div class="m-dropdown">
  <ul class="m-dropdown__list" [hidden]="!showMenu">
    <!-- owner functions -->
    <li
      class="m-dropdownList__item"
      *ngIf="group['is:owner']"
      (click)="openEditModal()"
      i18n="@@MINDS__COMMON__EDIT"
    >
      Edit
    </li>

    <li
      class="m-dropdownList__item"
      *ngIf="group['is:owner'] && group.videoChatDisabled"
      (click)="toggleVideoChat(true)"
    >
      Enable Gathering
    </li>
    <li
      class="m-dropdownList__item"
      *ngIf="group['is:owner'] && !group.videoChatDisabled"
      (click)="toggleVideoChat(false)"
    >
      Disable Gathering
    </li>

    <li
      class="m-dropdownList__item"
      *ngIf="
        (group['is:owner'] || group['is:moderator']) &&
        group.conversationDisabled
      "
      (click)="toggleConversation(true); showMenu = false"
      i18n="@@GROUPS__PROFILE__GROUP_SETTINGS_BTN__ENABLE_CONVERSATION"
    >
      Enable Conversation
    </li>
    <li
      class="m-dropdownList__item"
      *ngIf="
        (group['is:owner'] || group['is:moderator']) &&
        !group.conversationDisabled
      "
      (click)="toggleConversation(false); showMenu = false"
      i18n="@@GROUPS__PROFILE__GROUP_SETTINGS_BTN__DISABLE_CONVERSATION"
    >
      Disable Conversation
    </li>

    <!-- Member functions -->
    <li
      class="m-dropdownList__item"
      [hidden]="group['is:muted']"
      (click)="mute()"
      i18n="@@GROUPS__PROFILE__GROUP_SETTINGS_BTN__DISABLE_NOTIFICATIONS"
    >
      Disable Notifications
    </li>
    <li
      class="m-dropdownList__item"
      [hidden]="!group['is:muted']"
      (click)="unmute()"
      i18n="@@GROUPS__PROFILE__GROUP_SETTINGS_BTN__ENABLE_NOTIFICATIONS"
    >
      Enable Notifications
    </li>

    <!-- admin functions -->
    <li
      class="m-dropdownList__item"
      *ngIf="session.isAdmin() && !group.mature"
      (click)="setExplicit(true)"
      i18n="@@M__ACTION__SET_EXPLICIT"
    >
      Set Explicit
    </li>
    <li
      class="m-dropdownList__item"
      *ngIf="session.isAdmin() && group.mature"
      (click)="setExplicit(false)"
      i18n="@@M__ACTION__REMOVE_EXPLICIT"
    >
      Remove Explicit
    </li>
    <li
      class="m-dropdownList__item"
      (click)="report(); showMenu = false"
      i18n="@@M__ACTION__REPORT"
    >
      Report
    </li>
    <li
      class="m-dropdownList__item"
      *ngIf="group['is:creator']"
      [hidden]="group.deleted"
      (click)="deletePrompt()"
      i18n="@@GROUPS__PROFILE__GROUP_SETTINGS_BTN__DELETE_GROUP"
      data-cy="data-minds-group-dropdown-delete"
    >
      Delete Group
    </li>
  </ul>
</div>
<div
  class="minds-bg-overlay"
  (click)="toggleMenu($event)"
  [hidden]="!showMenu"
></div>

<m-modal [open]="group['is:owner'] && isGoingToBeDeleted">
  <div class="mdl-card__supporting-text">
    <p i18n="@@GROUPS__PROFILE__GROUP_SETTINGS_BTN__DELETE_GROUP_CONFIRM">
      Are you sure you want to delete {{ group.name }}? This action cannot be
      undone.
    </p>
  </div>
  <div class="mdl-card__actions">
    <button
      (click)="delete()"
      class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"
    >
      <ng-container i18n="@@M__ACTION__CONFIRM">Confirm</ng-container>
    </button>
    <button
      (click)="cancelDelete()"
      class="mdl-button mdl-js-button mdl-button--colored"
    >
      <ng-container i18n="@@M__ACTION__CANCEL">Cancel</ng-container>
    </button>
  </div>
</m-modal>

<m-modal [open]="featureModalOpen" (closed)="onFeatureModalClose($event)">
  <div class="m-button-feature-modal">
    <select [(ngModel)]="category">
      <option value="not-selected" i18n="@@M__COMMON__SELECT_A_CATEGORY"
        >-- SELECT A CATEGORY --
      </option>
      <option *ngFor="let category of categories" [value]="category.id">{{
        category.label
      }}</option>
    </select>

    <button
      class="mdl-button mdl-button--colored"
      (click)="feature()"
      i18n="@@M__ACTION__FEATURE"
    >
      Feature
    </button>
  </div>
</m-modal>
