<div class="m-mediaModal mdl-shadow--4dp">
  <!-- This is the element that goes into fullscreen -->
  <!-- <div class="m-mediaModal__theater"> -->
    <!-- Media: image -->
    <div class="m-mediaModal__theater m-mediaModal__theater--image" *ngIf="entity.modal_subtype === 'image'">
      <img [src]="entity.thumbnail" (load)="inProgress = !inProgress"/>
      <div class="mdl-spinner mdl-js-spinner is-active" [mdl] *ngIf="inProgress"></div>
      <div class="m-mediaModal__theaterOverlay">
        <a class="m-mediaModal__theaterOverlayTitle" [routerLink]="['/media', entity.entity_guid]">{{title}}</a>
        <div class="m-mediaModal__fullscreenButton"
          (click)="toggleFullscreen()"
          (mouseenter)="hovering=true"
          (mouseleave)="hovering=false"
          [class.m-mediaModal__fullscreenButton--active]="hovering"
          >
          <i *ngIf="!isFullscreen" class="material-icons m-mediaModal__fullscreenIcon--enable">fullscreen</i>
          <i *ngIf="isFullscreen" class="material-icons m-mediaModal__fullscreenIcon--disable">fullscreen_exit</i>
        </div>
      </div>
    </div>
    <!-- Media: video -->
    <div class="m-mediaModal__theater m-mediaModal__theater--video" *ngIf="entity.modal_subtype === 'video'">
      <m-video
        width="100%"
        height="300px"
        [muted]="false"
        [poster]="entity.custom_data.thumbnail_src"
        [src]="[{ 'res': '360', 'uri': 'api/v1/media/' + entity.custom_data.guid + '/play', 'type': 'video/mp4' }]"
        [guid]="entity.custom_data.guid"
        [playCount]="entity['play:count']"
        [torrent]="[{ res: '360', key: entity.custom_data.guid + '/360.mp4' }]"
        #player>
        <video-ads [player]="player" *ngIf="entity.monetized"></video-ads>
      </m-video>
    </div>
  <!-- </div> -->
  <div class="m-mediaModal__contentWrapper">
    <!-- Owner block -->
    <div class="m-mediaModal__ownerBlock m-owner-block">
      <div class="m-ownerBlockAvatar avatar" [hovercard]="entity.ownerObj.guid">
        <a [routerLink]="['/', entity.ownerObj.username]">
          <img [src]="minds.cdn_url + 'icon/' + entity.ownerObj.guid + '/medium/' + getOwnerIconTime()" class="mdl-shadow--2dp"/>
        </a>
      </div>
      <div class="m-ownerBlockBody body">
        <a class="m-ownerBlock__channelLink" [routerLink]="['/', entity.ownerObj.username]">
          <strong title={{entity.ownerObj.name}}>{{entity.ownerObj.name}}</strong>
          <m-channel--badges class="m-channel--badges-entity" [user]="entity.ownerObj" badges="[ 'admin', 'verified' ]"></m-channel--badges>
        </a>
        <a *ngIf="entity.containerObj && entity.containerObj.type == 'group'"
          [routerLink]="['/groups/profile', entity.containerObj.guid]"
          class="m-ownerBlock__groupLink mdl-color-text--blue-grey-300">
          <strong>({{entity.containerObj.name}})</strong>
        </a>
        <!-- Permalink -->
        <a [routerLink]="['/newsfeed', entity.guid]" class="permalink m-ownerBlock__permalink" *ngIf="entity.guid && !entity.remind_object">
          <span class="m-ownerBlock__permalinkDate">{{entity.time_created * 1000 | date:'medium'}}</span>
          <span *ngIf="entity.edited" class="m-ownerBlock__permalinkFlag m-ownerBlock__permalinkFlag--edited" i18n="@@M__COMMON__EDITED">edited</span>
          <div *ngIf="boosted"
            class="mdl-card__supporting-text m-ownerBlock__permalinkFlag m-ownerBlock__permalinkFlag--boosted"
            [class.m-ownerBlock__permalinkFlag--onchain]="entity.boosted_onchain"
            >
            <i class="material-icons">trending_up</i>
            <a i18n="@@MINDS__CARDS__entity__BOOSTED_LABEL" [hidden]="entity.boosted_onchain">Boosted</a>
            <a i18n="@@MINDS__CARDS__entity__BOOSTED_LABEL_ONCHAIN" [hidden]="!entity.boosted_onchain" [routerLink]="['/token']">Boosted Onchain</a>
          </div>
        </a>
      </div>
    </div>
    <!-- Action buttons -->
    <div class="m-mediaModal__actionButtonsWrapper">
      <div class="m-mediaModal__actionButtonsRow m-action-tabs">
        <m-wire-button *ngIf="session.getLoggedInUser().guid != entity.owner_guid"
          [object]="entity"
          (done)="wireSubmitted($event)"
        ></m-wire-button>
        <minds-button-thumbs-up [object]="entity"></minds-button-thumbs-up>
        <minds-button-thumbs-down [object]="entity"></minds-button-thumbs-down>
        <minds-button-remind [object]="entity"></minds-button-remind>
      </div>
    </div>
    <!-- Comments -->
    <div class="m-mediaModal__commentsWrapper" *ngIf="entity.guid">
      <m-comments__tree
        *ngIf="group?.guid"
        class="m-group__chat"
        [limit]="24"
        [entity]="entity"
        [conversation]="true"
        [canDelete]="group['is:moderator'] || group['is:creator']"
        [readonly]="!group['is:member']"
        [scrollable]="true"
      >
      </m-comments__tree>
    </div>
  </div>
</div>
